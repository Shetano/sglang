Building wheels for collected packages: transformer-engine, flash-attn
  Created temporary directory: /tmp/pip-wheel-0puoc_o1
  Building wheel for transformer-engine (setup.py) ...   Destination directory: /tmp/pip-wheel-0puoc_o1
  Running command python setup.py bdist_wheel
  /usr/local/lib/python3.10/dist-packages/torch/cuda/__init__.py:129: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 802: system not yet initialized (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
    return torch._C._cuda_getDeviceCount() > 0
  No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
  WARNING: Skipping transformer_engine_cu12 as it is not installed.
  WARNING: Skipping transformer_engine_torch as it is not installed.
  WARNING: Skipping transformer_engine_paddle as it is not installed.
  WARNING: Skipping transformer_engine_jax as it is not installed.
  /usr/lib/python3/dist-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
    warnings.warn(
  running bdist_wheel
  /usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py:497: UserWarning: Attempted to use ninja as the BuildExtension backend but we could not find ninja.. Falling back to using the slow distutils backend.
    warnings.warn(msg.format('we could not find ninja.'))
  running build
  running build_py
  running egg_info
  writing transformer_engine.egg-info/PKG-INFO
  writing dependency_links to transformer_engine.egg-info/dependency_links.txt
  writing requirements to transformer_engine.egg-info/requires.txt
  writing top-level names to transformer_engine.egg-info/top_level.txt
  reading manifest file 'transformer_engine.egg-info/SOURCES.txt'
  adding license file 'LICENSE'
  writing manifest file 'transformer_engine.egg-info/SOURCES.txt'
  error: [Errno 1] Operation not permitted: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/common.cu'
  error: subprocess-exited-with-error

  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> See above for output.

  note: This error originates from a subprocess, and is likely not a problem with pip.
  full command: /usr/bin/python3 -u -c '
  exec(compile('"'"''"'"''"'"'
  # This is <pip-setuptools-caller> -- a caller that pip uses to run setup.py
  #
  # - It imports setuptools before invoking setup.py, to enable projects that directly
  #   import from `distutils.core` to work with newer packaging standards.
  # - It provides a clear error message when setuptools is not installed.
  # - It sets `sys.argv[0]` to the underlying `setup.py`, when invoking `setup.py` so
  #   setuptools doesn'"'"'t think the script is `-c`. This avoids the following warning:
  #     manifest_maker: standard file '"'"'-c'"'"' not found".
  # - It generates a shim setup.py, for handling setup.cfg-only projects.
  import os, sys, tokenize

  try:
      import setuptools
  except ImportError as error:
      print(
          "ERROR: Can not execute `setup.py` since setuptools is not available in "
          "the build environment.",
          file=sys.stderr,
      )
      sys.exit(1)

  __file__ = %r
  sys.argv[0] = __file__

  if os.path.exists(__file__):
      filename = __file__
      with tokenize.open(__file__) as f:
          setup_py_code = f.read()
  else:
      filename = "<auto-generated setuptools caller>"
      setup_py_code = "from setuptools import setup; setup()"

  exec(compile(setup_py_code, filename, "exec"))
  '"'"''"'"''"'"' % ('"'"'/home/ubuntu/TransformerEngine/setup.py'"'"',), "<pip-setuptools-caller>", "exec"))' bdist_wheel -d /tmp/pip-wheel-0puoc_o1
  cwd: /home/ubuntu/TransformerEngine/
error
  ERROR: Failed building wheel for transformer-engine
  Running setup.py clean for transformer-engine
  Running command python setup.py clean
  /usr/local/lib/python3.10/dist-packages/torch/cuda/__init__.py:129: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 802: system not yet initialized (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
    return torch._C._cuda_getDeviceCount() > 0
  No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
  WARNING: Skipping transformer_engine_cu12 as it is not installed.
  WARNING: Skipping transformer_engine_torch as it is not installed.
  WARNING: Skipping transformer_engine_paddle as it is not installed.
  WARNING: Skipping transformer_engine_jax as it is not installed.
  /usr/lib/python3/dist-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
    warnings.warn(
  running clean
  removing 'build/lib.linux-x86_64-3.10' (and everything under it)
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/fused_attn.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/_common.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/padding.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/gemm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/normalization.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/transpose.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/activation.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions/cast.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpp_extensions'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/constants.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/tensor/quantized_tensor.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/tensor/float8_tensor.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/tensor/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/tensor'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/gemm.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/transpose.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/multi_tensor/multi_tensor_sgd_kernel.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/multi_tensor/multi_tensor_l2norm_kernel.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/multi_tensor/multi_tensor_scale_kernel.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/multi_tensor/multi_tensor_adam.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/multi_tensor'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/attention.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/padding.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/cast.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/normalization.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/recipe.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/pybind.cpp'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/softmax.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/activation.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/apply_rope.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/permutation.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions/misc.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/extensions'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/ts_fp8_op.cpp'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/userbuffers/userbuffers-host.cpp'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/userbuffers/ipcsocket.cc'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/userbuffers'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc/common.cu'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/csrc'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/export.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/optimizers/fused_adam.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/optimizers/multi_tensor_apply.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/optimizers/fused_sgd.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/optimizers/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/optimizers'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/setup.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/utils.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/jit.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/te_onnx_extensions.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/op.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fused/forward_linear_bias_activation.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fused/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fused/backward_linear_add.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fused/forward_linear_bias_add.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fused'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/reduce_scatter.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/bias.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/add_in_place.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/reshape.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/all_reduce.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/all_gather.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/identity.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/make_extra_output.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic/basic_linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/basic'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/_common.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/fuser.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/sequential.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/ops'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/float8_tensor.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/numerics_debug.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/attention.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/fp8.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/rmsnorm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/layernorm_mlp.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/_common.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/layernorm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/fp8_unpadding.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/layernorm_linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/base.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/grouped_linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module/fp8_padding.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/module'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/softmax.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/transformer.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/distributed.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/cpu_offload.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/graph.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch/permutation.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/pytorch'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/constants.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/rmsnorm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/layernorm_mlp.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/layernorm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/layernorm_linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/linear.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/attention.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/softmax.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/transformer.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer/base.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/layer'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/cpp_extensions.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/setup.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/utils.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/fp8_buffer.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/fp8.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/recompute.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/distributed.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle/profile.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/paddle'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/custom_call.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/quantization.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/attention.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/softmax.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/base.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/misc.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/normalization.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/transpose.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions/activation.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/cpp_extensions'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/sharding.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/layernorm_mlp.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/flax/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/flax/transformer.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/flax/module.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/flax'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/layernorm.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/setup.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/praxis/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/praxis/transformer.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/praxis/module.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/praxis'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/attention.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/fp8.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/dot.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax/softmax.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/jax'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/common/utils.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/common/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/common/recipe/__init__.py'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/common/recipe'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine/common'
  error removing build/lib.linux-x86_64-3.10: [Errno 13] Permission denied: 'build/lib.linux-x86_64-3.10/transformer_engine'
  error removing build/lib.linux-x86_64-3.10: [Errno 39] Directory not empty: 'build/lib.linux-x86_64-3.10'
  'build/bdist.linux-x86_64' does not exist -- can't clean it
  'build/scripts-3.10' does not exist -- can't clean it
  Created temporary directory: /tmp/pip-wheel-5xovj7i_
  Building wheel for flash-attn (setup.py) ...   Destination directory: /tmp/pip-wheel-5xovj7i_
  Running command python setup.py bdist_wheel
  /usr/local/lib/python3.10/dist-packages/torch/cuda/__init__.py:129: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 802: system not yet initialized (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
    return torch._C._cuda_getDeviceCount() > 0
  No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
  fatal: not a git repository (or any of the parent directories): .git


  torch.__version__  = 2.5.1+cu124


  /usr/lib/python3/dist-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
    warnings.warn(
  running bdist_wheel
  Guessing wheel URL:  https://github.com/Dao-AILab/flash-attention/releases/download/v2.6.3/flash_attn-2.6.3+cu123torch2.5cxx11abiFALSE-cp310-cp310-linux_x86_64.whl
  Precompiled wheel not found. Building from source...
  /usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py:497: UserWarning: Attempted to use ninja as the BuildExtension backend but we could not find ninja.. Falling back to using the slow distutils backend.
    warnings.warn(msg.format('we could not find ninja.'))
